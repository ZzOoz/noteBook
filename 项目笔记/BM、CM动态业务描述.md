# BM、CM动态业务描述



### 1、业务描述

**描述：**根据所在的班级通过瀑布流展示动态列表内容、可以自行切换班级查看对应的动态列表内容、能够发布图片的视频内容，并选择对应的发布范围和是否允许评论、在点击对应的动态进入详情后，可以查看详细的动态内容（视频、图片、文本内容、评论内容等），可以进行上下切换动态详情内容、当用户发布图片时可以左右滑动切换图片、视频无左右滑动切换（只有一个）



### 2、技术难点

#### **2.1、瀑布流内容展示动态内容**

描述：瀑布流通过图片等宽不等高、以两列的方式进行展示、并能够无限滚动、实现通过vue的瀑布流插件传入数据data，并通过slot插入自定义结构内容（头像、昵称、点赞数目）



#### **2.2、图片和视频发布**

描述：用户通过发布按钮选择发布视频或者图片，选择完成后需要跳转对应的页面，这时候需要将file对象传到后续页面中，后续页面通过数组接受多个file对象并经过处理后发送给后端，而视频内容则通过video标签接收



#### 2.3、**发布范围组件**

描述：用户通过选择发布范围来发布动态、需要使用van-collpase折叠面板和checkbox-group来结合实现，拿到用户的发布范围列表数据，渲染出对应的班级（或课程），并在拿到对应数据的时候新增一个select属性（用来标记是否被选中），全选的情况下选中所有，未选中的情况下清空数组



#### **2.4、上下切换动态详情**

描述：通过swiper里面的slideNextTransitionStart和slidePrevTransitionStart结合使用，并在动态详情的上下新增silder-side标签（隐藏掉），当用户向上或者向下切换时通过上一个动态id或者下一个动态id进行请求切换对应的详情、并在App.vue中的router-view里面绑定:key="$route.fullPath"（相同的组件下不同path也会重新渲染组件，触发mounted以前的生命周期）



#### **2.5、评论内容**

描述：评论分成一级评论和二级评论以及二级评论中的回复，用户发布一级评论通过只需要content内容、动态id，发布二级内容需要对应的content内容、动态id以及一级评论的id，发布三级内容需要content内容、动态id、一级评论的id、二级评论id，同时二级评论删除时需要一个长按事件，可以通过touchStart和touchEnd来模拟用户的长按事件（在touchStart中设置定时器，在touchEnd消除定时器）